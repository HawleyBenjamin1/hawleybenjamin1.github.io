---
layout: post
title: 'Day 297: How Machines Learn'
date: 2024-04-23 19:16:35.000000000 -04:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Daily
tags:
- ai
- artificial-intelligence
- author
- authors
- blog
- books
- dangerousdayjob
- data-science
- deep-learning
- fantasy
- literature
- machine-learning
- sci fi
- writing
meta:
  _jetpack_memberships_contains_paywalled_content: ''
  _jetpack_memberships_contains_paid_content: ''
  _last_editor_used_jetpack: block-editor
  wordads_ufa: s:wpcom-ufa-v4:1713982611
  reader_suggested_tags: '["Artificial Intelligence","Machine Learning","AI","Deep-learning","Data
    Science"]'
  firehose_sent: '1713914197'
  timeline_notification: '1713914199'
  _publicize_job_id: '93912272905'
  _elasticsearch_data_sharing_indexed_on: '2024-07-17 14:19:34'
author:
  login: bhawleywrites
  email: hawleybenjamin1@gmail.com
  display_name: bhawleywrites
  first_name: ''
  last_name: ''
permalink: "/2024/04/23/day-297-how-machines-learn/"
---
<p><!-- wp:paragraph --></p>
<p>I took a break from writing over the weekend to explore a little in a totally different field. I find it's good to broaden my horizons as much as I can to find new sources for my writing. In this case, I also just really wanted to know how machine learning algorithms actually function. You see them all over the news these days, from complex models like ChatGPT and the perceptrons behind self-driving cars, to simple sentiment analyzers that allow huge corporations to figure out how everyone who has ever posted about them feels about the company. Everyone seems to believe these models are the future, for better or worse. If they're right, then I must ask, how will this future actually function at a fundamental level? That's what I wanted to figure out, so I built one.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>First I need to constrain what I'm talking about though. Machine learning encompasses a huge field. What I was interested in is called deep learning, where neural networks are used to extract and classify input data. What I find most interesting about neural networks is that they're specifically designed to mimic the decision making capability of organic brains. Our eyes send us images, and based on that data, we can tell we're looking at a cat, or a dog, or even if we're looking at something we've never seen before. We can find patterns in sequences of numbers, search for meaning in text, and identify each other based on the sound of our voices. These are all problems encompassed by deep learning that can be solved using neural networks. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Not all machine learning is deep learning. Deep learning specifically refers the use of a neural network to extract features and classify data based on those features. Machine learning applications can classify data without the use of such a complex algorithm as a neural network and are actually much better in many scenarios. <a href="https://www.turing.com/kb/ultimate-battle-between-deep-learning-and-machine-learning">There are some other major differences you can read more about at here at turing.com</a>. Just wanted to make that clear before we move on.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Here's the gist of a neural network. You may have seen something similar before:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":2793,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{ site.baseurl }}/assets/2024/04/image-6.png?w=1024" alt="" class="wp-image-2793" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Inputs come in, stuff happens, outputs come out. Simple. And actually, when you dig into the individual steps, they are simpler than you might expect. It's by combining a large number of simple steps that these algorithms achieve their complexity. Let's start with the neuron, the circles you see up there. What are they really? They actually only hold a couple pieces of information:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Neuron<br />- Weights<br />- Bias</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>That's it. Each of those circles has nothing but. And in fact, they don't even really exist as you might think of them. There is no object called a neuron in any neural network as far as I'm aware. That's because there's a better way to represent them. Putting them into layers of neurons is much easier than creating a hefty container for each and every neuron. It will become obvious why this is the case as you keep reading.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Each layer looks more like this when you're actually working with them:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Weights:<br />[</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>[-0.2,    0.01, 0.1, -0.01,  0.04],<br />[ 0.01, -0.02, 0.1, -0.02, -0.01],<br />[ 0.1,    0.17, 0.25, 0.06,  0.06],<br />[ 0.2, -0.01, -0.03, 0.02, -0.03]</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>]</p>
<p>Biases:<br />[[0, 0, 0, 0, 0]]</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Maybe you're thinking, ew, numbers. It's not as bad as it looks. Each bracketed set of numbers [ ] is called an array. Both of these are arrays of arrays, or two dimensional arrays. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>In the weights array, the number of rows indicates how many inputs the layer will receive. In this case four rows, so four inputs. Those four inputs could come from a previous layer, but for this particular example, each sample of our input data is made up of four numbers, like this:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Inputs:<br />[</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>[1, 2, 3, 2.5]</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>]</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>That's a single sample. Later we might look at multiple samples, but for now, it'll be just the one.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>But back to the weights array. The number of columns indicates the number of neurons in the layer, in this case five.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>    1     2      3       4       5<br />[-0.2, 0.01, 0.1, -0.01, 0.04],<br />[ 0.01, -0.02, 0.1, -0.02, -0.01],<br />[ 0.1, 0.17, 0.25, 0.06, 0.06],<br />[ 0.2, -0.01, -0.03, 0.02, -0.03]</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Each number in a column represents the weight of the input to the neuron that the column represents. You could think of this weight as how much credence the neuron will give each input. A big weight means that particular input will have a big impact on the output of the neuron. A small weight will reduce the impact of the input to the neuron. These are adjusted later to tune the network during training.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Next up, the biases. Each neuron has one bias. There are five columns in the weights array, so there should be five columns in the biases array. You might be wondering, why not one bias per input, per neuron like we have with weights? This is to give the network the ability to adjust different aspects of the system later on. Different kinds of knobs on the machine, so to speak.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>How are these actually used by each neuron? It's a simple formula:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>output = sum (weights x inputs) + bias</strong></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>This layer has five neurons. Each neuron takes four inputs and has one weight associated with each input. It multiplies each input by each weight, then adds them all together, and adds the neuron's bias on top of that. 20 multiplications, and then it sums them up. A larger network might look like this. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":2802,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{ site.baseurl }}/assets/2024/04/neuralnetwork.jpg?w=633" alt="" class="wp-image-2802" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Each line is a weight associated with the previous neuron's output, which becomes the next neuron's input. The biases aren't listed, but frankly they aren't as important as the weights anyway. Each neuron has only one output, but that output is piped to each neuron in the next layer. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>You might still be wondering, why put them in layers? Because a nice mathematician named Lagrange invented a something called the dot product way back in 1773. Today, we use the dot product to trick rocks into thinking for us. Crazy.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Anyway the dot product is at the heart of matrix multiplication. A matrix is essentially just like an array, at least for our purposes today. Here is an image I stole from Medium.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"lightbox":{"enabled":false},"id":2806,"width":"476px","height":"auto","sizeSlug":"large","linkDestination":"custom"} --></p>
<figure class="wp-block-image size-large is-resized"><a href="https://charchithowitzer.medium.com/matrix-multiplication-why-is-it-a-big-deal-cc8ef7490008" /><img src="{{ site.baseurl }}/assets/2024/04/image-10.png?w=387" alt="" class="wp-image-2806" style="width:476px;height:auto" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>It's not too complicated, but it does stretch your brain a little. Multiply each element in the row by each element in the column, then add them all together to get one number. Do this for every combination of rows and columns, and you'll end up with a new matrix at the end. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Using this technique, we can do all the multiplication and addition we need all at once rather than going one neuron at a time. Hence putting the neurons into 'layers' which are actually just arrays, which act exactly like a matrix in this case ... Getting kinda convoluted here, but if you're still following, here's a cookie. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Here's our inputs again, tidyed up some to look more like a matrix.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>[1,   2,  3,  2.5]</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>And our weights</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>[-0.2,    0.01, 0.1, -0.01,  0.04]<br />[ 0.01, -0.02, 0.1, -0.02, -0.01]<br />[ 0.1,    0.17, 0.25, 0.06,  0.06]<br />[ 0.2, -0.01, -0.03, 0.02, -0.03]</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>First multiply each of these, then add the results together.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong><strong>[1,   2,  3,  2.5]</strong></strong></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>[-0.2,  </strong>  0.01, 0.1, -0.01,  0.04]<br /><strong>[ 0.01,</strong> -0.02, 0.1, -0.02, -0.01]<br /><strong>[ 0.1, </strong>   0.17, 0.25, 0.06,  0.06]<br /><strong>[ 0.2,</strong> -0.01, -0.03, 0.02, -0.03]</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Then the next column.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong><strong>[1,   2,  3,  2.5]</strong></strong></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>[-0.2,<strong>  </strong> <strong>0.01,</strong> 0.1,  -0.01, 0.04]<br />[ 0.01, -<strong>0.02</strong>, 0.1, -0.02, -0.01]<br />[ 0.1,<strong> </strong> <strong>0.17</strong>, 0.25,   0.06, 0.06]<br />[ 0.2, -<strong>0.01</strong>, -0.03, 0.02, -0.03]</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Then the next ... </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>[1,   2,  3,  2.5]</strong></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>[-0.2,<strong>  </strong> 0.01, <strong>0.1</strong>,  -0.01,  0.04]<br />[ 0.01, -0.02, <strong>0.1</strong>, -0.02, -0.01]<br />[ 0.1,<strong> </strong> 0.17, <strong>0.25</strong>,   0.06,  0.06]<br />[ 0.2, -0.01, -<strong>0.03</strong>, 0.02, -0.03]</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>And so on until you get this, one number per column because remember each column represents a neuron.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:table --></p>
<figure class="wp-block-table">
<table class="has-fixed-layout">
<tbody>
<tr /></tbody>
</table>
<th />
<th class="has-text-align-center" data-align="center">N1</th>
<th class="has-text-align-center" data-align="center">N2</th>
<th class="has-text-align-center" data-align="center">N3</th>
<th class="has-text-align-center" data-align="center">N4</th>
<td class="has-text-align-center" data-align="center" /><strong>N5</strong><br />
<tr />
<th>Output</th>
<td class="has-text-align-center" data-align="center">0.62</td>
<td class="has-text-align-center" data-align="center">0.455</td>
<td class="has-text-align-center" data-align="center">0.975</td>
<td class="has-text-align-center" data-align="center">0.18</td>
<td class="has-text-align-center" data-align="center">0.125</td>
</figure>
<p><!-- /wp:table --></p>
<p><!-- wp:paragraph --></p>
<p>Then add all the biases of each neuron to each output, which were all 0 if you remember, so we don't need to do anything more. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>This is the output of the layer.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>As these are just random numbers, the output is completely meaningless. It was just to help understand what the layer is actually doing.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Tomorrow I'll go over what the network actually does with this layer's output. After writing all this out, I realized how much background knowledge it really takes to grasp this. Without prior understanding of matrix multiplication, it can take some time to wrap your head around it. I didn't expect the post to go on so long honestly. Sorry about that. If you're still confused, <a href="https://www.khanacademy.org/search?referer=%2Fmath%2Fmultivariable-calculus%2Fthinking-about-multivariable-function%2Fx786f2022%3Avectors-and-matrices%2Fa%2Fmatrices--visualized-mvc&amp;page_search_query=matrix+multiplication">here's a Khan Academy lesson on matrix multiplication that should help.</a> </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Just remember: Weights times inputs plus the bias! If you can wrap your head around weights times inputs, then you'll have everything you need for tomorrow's post.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Thank you for reading,</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Benjamin Hawley</p>
<p><!-- /wp:paragraph --></p>
