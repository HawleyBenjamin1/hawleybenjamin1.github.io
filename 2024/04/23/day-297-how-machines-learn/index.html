<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Day 297: How Machines Learn | DangerousDayJob </title> <meta name="author" content="Benjamin Hawley"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://hawleybenjamin1.github.io/2024/04/23/day-297-how-machines-learn/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> DangerousDayJob </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Day 297: How Machines Learn</h1> <p class="post-meta"> Created in April 23, 2024 by {"login"=&gt;"bhawleywrites", "email"=&gt;"hawleybenjamin1@gmail.com", "display_name"=&gt;"bhawleywrites", "first_name"=&gt;"", "last_name"=&gt;""} • {"_jetpack_memberships_contains_paywalled_content"=&gt;"", "_jetpack_memberships_contains_paid_content"=&gt;"", "_last_editor_used_jetpack"=&gt;"block-editor", "wordads_ufa"=&gt;"s:wpcom-ufa-v4:1713982611", "reader_suggested_tags"=&gt;"[\"Artificial Intelligence\",\"Machine Learning\",\"AI\",\"Deep-learning\",\"Data Science\"]", "firehose_sent"=&gt;"1713914197", "timeline_notification"=&gt;"1713914199", "_publicize_job_id"=&gt;"93912272905", "_elasticsearch_data_sharing_indexed_on"=&gt;"2024-07-17 14:19:34"} </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2024   ·   <i class="fa-solid fa-hashtag fa-sm"></i> ai   <i class="fa-solid fa-hashtag fa-sm"></i> artificial-intelligence   <i class="fa-solid fa-hashtag fa-sm"></i> author   <i class="fa-solid fa-hashtag fa-sm"></i> authors   <i class="fa-solid fa-hashtag fa-sm"></i> blog   <i class="fa-solid fa-hashtag fa-sm"></i> books   <i class="fa-solid fa-hashtag fa-sm"></i> dangerousdayjob   <i class="fa-solid fa-hashtag fa-sm"></i> data-science   <i class="fa-solid fa-hashtag fa-sm"></i> deep-learning   <i class="fa-solid fa-hashtag fa-sm"></i> fantasy   <i class="fa-solid fa-hashtag fa-sm"></i> literature   <i class="fa-solid fa-hashtag fa-sm"></i> machine-learning   <i class="fa-solid fa-hashtag fa-sm"></i> sci fi   <i class="fa-solid fa-hashtag fa-sm"></i> writing   ·   <i class="fa-solid fa-tag fa-sm"></i> Daily </p> </header> <article class="post-content"> <div id="markdown-content"> <p></p> <p>I took a break from writing over the weekend to explore a little in a totally different field. I find it's good to broaden my horizons as much as I can to find new sources for my writing. In this case, I also just really wanted to know how machine learning algorithms actually function. You see them all over the news these days, from complex models like ChatGPT and the perceptrons behind self-driving cars, to simple sentiment analyzers that allow huge corporations to figure out how everyone who has ever posted about them feels about the company. Everyone seems to believe these models are the future, for better or worse. If they're right, then I must ask, how will this future actually function at a fundamental level? That's what I wanted to figure out, so I built one.</p> <p></p> <p></p> <p>First I need to constrain what I'm talking about though. Machine learning encompasses a huge field. What I was interested in is called deep learning, where neural networks are used to extract and classify input data. What I find most interesting about neural networks is that they're specifically designed to mimic the decision making capability of organic brains. Our eyes send us images, and based on that data, we can tell we're looking at a cat, or a dog, or even if we're looking at something we've never seen before. We can find patterns in sequences of numbers, search for meaning in text, and identify each other based on the sound of our voices. These are all problems encompassed by deep learning that can be solved using neural networks. </p> <p></p> <p></p> <p>Not all machine learning is deep learning. Deep learning specifically refers the use of a neural network to extract features and classify data based on those features. Machine learning applications can classify data without the use of such a complex algorithm as a neural network and are actually much better in many scenarios. <a href="https://www.turing.com/kb/ultimate-battle-between-deep-learning-and-machine-learning" rel="external nofollow noopener" target="_blank">There are some other major differences you can read more about at here at turing.com</a>. Just wanted to make that clear before we move on.</p> <p></p> <p></p> <p>Here's the gist of a neural network. You may have seen something similar before:</p> <p></p> <p></p> <figure class="wp-block-image size-large"><img src="/assets/2024/04/image-6.png?w=1024" alt="" class="wp-image-2793"></figure> <p></p> <p></p> <p>Inputs come in, stuff happens, outputs come out. Simple. And actually, when you dig into the individual steps, they are simpler than you might expect. It's by combining a large number of simple steps that these algorithms achieve their complexity. Let's start with the neuron, the circles you see up there. What are they really? They actually only hold a couple pieces of information:</p> <p></p> <p></p> <p>Neuron<br>- Weights<br>- Bias</p> <p></p> <p></p> <p>That's it. Each of those circles has nothing but. And in fact, they don't even really exist as you might think of them. There is no object called a neuron in any neural network as far as I'm aware. That's because there's a better way to represent them. Putting them into layers of neurons is much easier than creating a hefty container for each and every neuron. It will become obvious why this is the case as you keep reading.</p> <p></p> <p></p> <p>Each layer looks more like this when you're actually working with them:</p> <p></p> <p></p> <p>Weights:<br>[</p> <p></p> <p></p> <p>[-0.2, 0.01, 0.1, -0.01, 0.04],<br>[ 0.01, -0.02, 0.1, -0.02, -0.01],<br>[ 0.1, 0.17, 0.25, 0.06, 0.06],<br>[ 0.2, -0.01, -0.03, 0.02, -0.03]</p> <p></p> <p></p> <p>]</p> <p>Biases:<br>[[0, 0, 0, 0, 0]]</p> <p></p> <p></p> <p>Maybe you're thinking, ew, numbers. It's not as bad as it looks. Each bracketed set of numbers [ ] is called an array. Both of these are arrays of arrays, or two dimensional arrays. </p> <p></p> <p></p> <p>In the weights array, the number of rows indicates how many inputs the layer will receive. In this case four rows, so four inputs. Those four inputs could come from a previous layer, but for this particular example, each sample of our input data is made up of four numbers, like this:</p> <p></p> <p></p> <p>Inputs:<br>[</p> <p></p> <p></p> <p>[1, 2, 3, 2.5]</p> <p></p> <p></p> <p>]</p> <p></p> <p></p> <p>That's a single sample. Later we might look at multiple samples, but for now, it'll be just the one.</p> <p></p> <p></p> <p>But back to the weights array. The number of columns indicates the number of neurons in the layer, in this case five.</p> <p></p> <p></p> <p> 1 2 3 4 5<br>[-0.2, 0.01, 0.1, -0.01, 0.04],<br>[ 0.01, -0.02, 0.1, -0.02, -0.01],<br>[ 0.1, 0.17, 0.25, 0.06, 0.06],<br>[ 0.2, -0.01, -0.03, 0.02, -0.03]</p> <p></p> <p></p> <p>Each number in a column represents the weight of the input to the neuron that the column represents. You could think of this weight as how much credence the neuron will give each input. A big weight means that particular input will have a big impact on the output of the neuron. A small weight will reduce the impact of the input to the neuron. These are adjusted later to tune the network during training.</p> <p></p> <p></p> <p>Next up, the biases. Each neuron has one bias. There are five columns in the weights array, so there should be five columns in the biases array. You might be wondering, why not one bias per input, per neuron like we have with weights? This is to give the network the ability to adjust different aspects of the system later on. Different kinds of knobs on the machine, so to speak.</p> <p></p> <p></p> <p>How are these actually used by each neuron? It's a simple formula:</p> <p></p> <p></p> <p><strong>output = sum (weights x inputs) + bias</strong></p> <p></p> <p></p> <p>This layer has five neurons. Each neuron takes four inputs and has one weight associated with each input. It multiplies each input by each weight, then adds them all together, and adds the neuron's bias on top of that. 20 multiplications, and then it sums them up. A larger network might look like this. </p> <p></p> <p></p> <figure class="wp-block-image size-large"><img src="/assets/2024/04/neuralnetwork.jpg?w=633" alt="" class="wp-image-2802"></figure> <p></p> <p></p> <p>Each line is a weight associated with the previous neuron's output, which becomes the next neuron's input. The biases aren't listed, but frankly they aren't as important as the weights anyway. Each neuron has only one output, but that output is piped to each neuron in the next layer. </p> <p></p> <p></p> <p>You might still be wondering, why put them in layers? Because a nice mathematician named Lagrange invented a something called the dot product way back in 1773. Today, we use the dot product to trick rocks into thinking for us. Crazy.</p> <p></p> <p></p> <p>Anyway the dot product is at the heart of matrix multiplication. A matrix is essentially just like an array, at least for our purposes today. Here is an image I stole from Medium.</p> <p></p> <p></p> <figure class="wp-block-image size-large is-resized"><a href="https://charchithowitzer.medium.com/matrix-multiplication-why-is-it-a-big-deal-cc8ef7490008" rel="external nofollow noopener" target="_blank"></a><img src="/assets/2024/04/image-10.png?w=387" alt="" class="wp-image-2806" style="width:476px;height:auto"></figure> <p></p> <p></p> <p>It's not too complicated, but it does stretch your brain a little. Multiply each element in the row by each element in the column, then add them all together to get one number. Do this for every combination of rows and columns, and you'll end up with a new matrix at the end. </p> <p></p> <p></p> <p>Using this technique, we can do all the multiplication and addition we need all at once rather than going one neuron at a time. Hence putting the neurons into 'layers' which are actually just arrays, which act exactly like a matrix in this case ... Getting kinda convoluted here, but if you're still following, here's a cookie. </p> <p></p> <p></p> <p>Here's our inputs again, tidyed up some to look more like a matrix.</p> <p></p> <p></p> <p>[1, 2, 3, 2.5]</p> <p></p> <p></p> <p>And our weights</p> <p></p> <p></p> <p>[-0.2, 0.01, 0.1, -0.01, 0.04]<br>[ 0.01, -0.02, 0.1, -0.02, -0.01]<br>[ 0.1, 0.17, 0.25, 0.06, 0.06]<br>[ 0.2, -0.01, -0.03, 0.02, -0.03]</p> <p></p> <p></p> <p>First multiply each of these, then add the results together.</p> <p></p> <p></p> <p><strong><strong>[1, 2, 3, 2.5]</strong></strong></p> <p></p> <p></p> <p><strong>[-0.2, </strong> 0.01, 0.1, -0.01, 0.04]<br><strong>[ 0.01,</strong> -0.02, 0.1, -0.02, -0.01]<br><strong>[ 0.1, </strong> 0.17, 0.25, 0.06, 0.06]<br><strong>[ 0.2,</strong> -0.01, -0.03, 0.02, -0.03]</p> <p></p> <p></p> <p>Then the next column.</p> <p></p> <p></p> <p><strong><strong>[1, 2, 3, 2.5]</strong></strong></p> <p></p> <p></p> <p>[-0.2,<strong> </strong> <strong>0.01,</strong> 0.1, -0.01, 0.04]<br>[ 0.01, -<strong>0.02</strong>, 0.1, -0.02, -0.01]<br>[ 0.1,<strong> </strong> <strong>0.17</strong>, 0.25, 0.06, 0.06]<br>[ 0.2, -<strong>0.01</strong>, -0.03, 0.02, -0.03]</p> <p></p> <p></p> <p>Then the next ... </p> <p></p> <p></p> <p><strong>[1, 2, 3, 2.5]</strong></p> <p></p> <p></p> <p>[-0.2,<strong> </strong> 0.01, <strong>0.1</strong>, -0.01, 0.04]<br>[ 0.01, -0.02, <strong>0.1</strong>, -0.02, -0.01]<br>[ 0.1,<strong> </strong> 0.17, <strong>0.25</strong>, 0.06, 0.06]<br>[ 0.2, -0.01, -<strong>0.03</strong>, 0.02, -0.03]</p> <p></p> <p></p> <p>And so on until you get this, one number per column because remember each column represents a neuron.</p> <p></p> <p></p> <figure class="wp-block-table"> <table class="has-fixed-layout"> <tbody> <tr></tr> </tbody> </table> <th></th> <th class="has-text-align-center" data-align="center">N1</th> <th class="has-text-align-center" data-align="center">N2</th> <th class="has-text-align-center" data-align="center">N3</th> <th class="has-text-align-center" data-align="center">N4</th> <td class="has-text-align-center" data-align="center"></td> <strong>N5</strong><br> <tr></tr> <th>Output</th> <td class="has-text-align-center" data-align="center">0.62</td> <td class="has-text-align-center" data-align="center">0.455</td> <td class="has-text-align-center" data-align="center">0.975</td> <td class="has-text-align-center" data-align="center">0.18</td> <td class="has-text-align-center" data-align="center">0.125</td> </figure> <p></p> <p></p> <p>Then add all the biases of each neuron to each output, which were all 0 if you remember, so we don't need to do anything more. </p> <p></p> <p></p> <p>This is the output of the layer.</p> <p></p> <p></p> <p>As these are just random numbers, the output is completely meaningless. It was just to help understand what the layer is actually doing.</p> <p></p> <p></p> <p>Tomorrow I'll go over what the network actually does with this layer's output. After writing all this out, I realized how much background knowledge it really takes to grasp this. Without prior understanding of matrix multiplication, it can take some time to wrap your head around it. I didn't expect the post to go on so long honestly. Sorry about that. If you're still confused, <a href="https://www.khanacademy.org/search?referer=%2Fmath%2Fmultivariable-calculus%2Fthinking-about-multivariable-function%2Fx786f2022%3Avectors-and-matrices%2Fa%2Fmatrices--visualized-mvc&amp;page_search_query=matrix+multiplication" rel="external nofollow noopener" target="_blank">here's a Khan Academy lesson on matrix multiplication that should help.</a> </p> <p></p> <p></p> <p>Just remember: Weights times inputs plus the bias! If you can wrap your head around weights times inputs, then you'll have everything you need for tomorrow's post.</p> <p></p> <p></p> <p>Thank you for reading,</p> <p></p> <p></p> <p>Benjamin Hawley</p> <p></p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/google-gemini-updates-flash-15-gemma-2-and-project-astra/">Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/displaying-external-posts-on-your-al-folio-blog/">Displaying External Posts on Your al-folio Blog</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/2025/01/07/day-472-well/">Day 472: Well ...</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/2025/01/06/day-471-back-to-work/">Day 471: Back to Work</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/2025/01/03/happy-friday/">Happy Friday</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Benjamin Hawley. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>